dist: xenial
cache: bundler
language: ruby
bundler_args: "--without development"

rvm:
- 2.6.3
- 2.5.5
- 2.4.6
- 2.3.8

gemfile:
- gemfiles/rails_5.2.gemfile
- gemfiles/rails_5.1.gemfile
- gemfiles/rails_5.0.gemfile
- gemfiles/rails_4.2.gemfile
- gemfiles/rails_master.gemfile

before_install:
- gem update --system
- gem install bundler

jobs:
  allow_failures:
  - gemfile: gemfiles/rails_master.gemfile
  exclude:
  - rvm: 2.3.8
    gemfile: gemfiles/rails_master.gemfile

  include:
  - stage: Release
    rvm: 2.6.3
    script: echo "Deploy to rubygems.org..."
    deploy:
      provider: rubygems
      api_key:
        secure: gbv5GB+upPRRcQuk685SzntPFL1ksEvf3CdujtMVXx7LIKTPPVib8HfE1ComkDpePhQSC/fbgDSQBlyiMRU6Lr/gMftxAa3614DjKmB17yC7at4PUPbYXf2ri18sVZyhHT0vPNwC40dIPjCP3vU7m551V5DyCpvXiod9Qq2W1oM=
      gem: acfs
      on:
        tags: true
        repo: jgraichen/acfs
